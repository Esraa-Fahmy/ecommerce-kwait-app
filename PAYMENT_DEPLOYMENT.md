# ๐ Payment Deep Link Deployment Guide

## ๐ Overview

ูุฐุง ุงูุฏููู ูุดุฑุญ ููููุฉ ูุดุฑ ุตูุญุงุช ุงูู redirect ููุฏูุน ูุญู ูุดููุฉ Deep Links ูุน MyFatoorah.

## ๐ด ุงููุดููุฉ

MyFatoorah ูุง ููููู ูุจูู deep links ูุจุงุดุฑุฉ (`3roudapp://payment-success`) ูู callback URLs ูุฃู:
- Deep links ููุณุช HTTP/HTTPS URLs
- ุจูุงุจุงุช ุงูุฏูุน ุชุญุชุงุฌ web URLs ููู redirect
- ุงุณุชุฎุฏุงู deep link ูุจุงุดุฑุฉ ูุณุจุจ ุฎุทุฃ `Cannot GET`

## โ ุงูุญู

ุงุณุชุฎุฏุงู ุตูุญุงุช HTML ูุณูุทุฉ ุนูู ุงูุฏูููู ุงูุฎุงุต ุจู ุชููู ุจุนูู redirect ููู deep link.

## ๐ ุงููููุงุช ุงููุทููุจุฉ

ุชู ุฅูุดุงุก ููููู HTML ูู ูุฌูุฏ `public/`:

1. **payment-success.html** - ุตูุญุฉ ุงููุฌุงุญ
2. **payment-error.html** - ุตูุญุฉ ุงููุดู

## ๐ ุฎุทูุงุช ุงููุดุฑ

### 1๏ธโฃ ุฑูุน ุงููููุงุช ุนูู ุงูุณูุฑูุฑ

ูู ุจุฑูุน ุงูููููู ุงูุชุงูููู ุฅูู ูููุนู `https://3roood.com`:

```
https://3roood.com/payment-success.html
https://3roood.com/payment-error.html
```

**ุทุฑู ุงูุฑูุน:**
- ุนุจุฑ FTP/SFTP
- ุนุจุฑ cPanel File Manager
- ุนุจุฑ SSH/SCP
- ุนุจุฑ Git deployment

### 2๏ธโฃ ุชุญุฏูุซ Environment Variables

ูู ููู `.env` ุนูู ุงูุณูุฑูุฑุ ูู ุจุชุญุฏูุซ ุงููุชุบูุฑุงุช ุงูุชุงููุฉ:

```env
# MyFatoorah Callback URLs
MYFATOORAH_SUCCESS_URL=https://3roood.com/payment-success.html
MYFATOORAH_ERROR_URL=https://3roood.com/payment-error.html
```

> **ููุงุญุธุฉ ูููุฉ:** ุงุณุชุฎุฏู ุงูุฏูููู ุงููุนูู `https://3roood.com` ูููุณ `https://3roood.com/api/v1`

### 3๏ธโฃ ุฅุนุงุฏุฉ ุชุดุบูู Backend

ุจุนุฏ ุชุญุฏูุซ `.env`ุ ูู ุจุฅุนุงุฏุฉ ุชุดุบูู ุงูู backend:

```bash
# ุฅุฐุง ููุช ุชุณุชุฎุฏู PM2
pm2 restart all

# ุฃู ุฅุฐุง ููุช ุชุณุชุฎุฏู systemd
sudo systemctl restart your-app-name

# ุฃู ุฅุฐุง ููุช ุชุณุชุฎุฏู Docker
docker-compose restart
```

## ๐ ููู ูุนูู ุงููุธุงู

### ุชุฏูู ุงูุฏูุน ุงููุงุฌุญ:

1. ุงููุณุชุฎุฏู ูููู ุงูุฏูุน ุนูู MyFatoorah โ
2. MyFatoorah ูุนูุฏ ุงูุชูุฌูู ุฅูู:
   ```
   https://3roood.com/payment-success.html?paymentId=123&orderId=456
   ```
3. ุตูุญุฉ HTML ุชุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ ูุชููู ุชููุงุฆูุงู ุจุงูุชูุฌูู ุฅูู:
   ```
   3roudapp://payment-success?paymentId=123&orderId=456
   ```
4. ุงูุชุทุจูู ููุชุญ ููุณุชูุจู ุงูุจูุงูุงุช ๐ฑ

### ุชุฏูู ุงูุฏูุน ุงููุงุดู:

1. ุงููุณุชุฎุฏู ููุบู ุฃู ููุดู ุงูุฏูุน โ
2. MyFatoorah ูุนูุฏ ุงูุชูุฌูู ุฅูู:
   ```
   https://3roood.com/payment-error.html?message=Payment+failed
   ```
3. ุตูุญุฉ HTML ุชุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ ูุชููู ุชููุงุฆูุงู ุจุงูุชูุฌูู ุฅูู:
   ```
   3roudapp://payment-error?message=Payment+failed
   ```
4. ุงูุชุทุจูู ููุชุญ ููุนุฑุถ ุฑุณุงูุฉ ุงูุฎุทุฃ ๐ฑ

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุงูุตูุญุงุช ูุจุงุดุฑุฉ:

ุงูุชุญ ูู ุงููุชุตูุญ:
```
https://3roood.com/payment-success.html?paymentId=test123&orderId=order456
https://3roood.com/payment-error.html?message=Test+error
```

ูุฌุจ ุฃู ุชุฑู:
- โ ุตูุญุฉ ุฌูููุฉ ูุน ุฑุณุงูุฉ ุงููุฌุงุญ/ุงููุดู
- ๐ Spinner ูุฏูุฑ
- ๐ฑ ูุญุงููุฉ ูุชุญ ุงูุชุทุจูู ุชููุงุฆูุงู
- ๐ ุฒุฑ ุงุญุชูุงุทู ูุธูุฑ ุจุนุฏ ุซุงููุชูู

### 2. ุงุฎุชุจุงุฑ ุงูุฏูุน ุงููุงูู:

1. ุงูุชุญ ุงูุชุทุจูู ุนูู Flutter
2. ุฃูุดุฆ ุทูุจ ุฌุฏูุฏ
3. ุงุฎุชุฑ ุงูุฏูุน ุจุงูููุฒุง
4. ุฃููู ุงูุฏูุน ุนูู MyFatoorah
5. ุชุญูู ูู:
   - โ ุงูุชูุฌูู ุฅูู ุตูุญุฉ HTML
   - โ ูุชุญ ุงูุชุทุจูู ุชููุงุฆูุงู
   - โ ุงุณุชูุงู `paymentId` ู `orderId`
   - โ ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงูุตูุญุฉ ูุง ุชูุชุญ (404)
**ุงูุญู:** ุชุฃูุฏ ูู ุฑูุน ุงููููุงุช ูู ุงููุณุงุฑ ุงูุตุญูุญ ุนูู ุงูุณูุฑูุฑ

### ุงููุดููุฉ: ุงูุชุทุจูู ูุง ููุชุญ
**ุงูุญู:** 
- ุชุฃูุฏ ูู ุชูููู Deep Links ูู Flutter ุจุดูู ุตุญูุญ
- ุชุญูู ูู `AndroidManifest.xml` ู `Info.plist`

### ุงููุดููุฉ: ูุง ูุชู ุชูุฑูุฑ ุงูุจุงุฑุงูุชุฑุงุช
**ุงูุญู:** 
- ุงูุชุญ Developer Console ูู ุงููุชุตูุญ
- ุชุญูู ูู ุงูู URL ุงูุฐู ูุชู ุงูุชูุฌูู ุฅููู
- ุชุฃูุฏ ูู ุฃู MyFatoorah ูุฑุณู `paymentId` ูู ุงูู callback

### ุงููุดููุฉ: ุงูู Backend ูุง ูุฒุงู ูุณุชุฎุฏู Deep Links
**ุงูุญู:**
- ุชุฃูุฏ ูู ุชุญุฏูุซ `.env` ุจุดูู ุตุญูุญ
- ุชุฃูุฏ ูู ุฅุนุงุฏุฉ ุชุดุบูู ุงูู Backend
- ุชุญูู ูู ุงูููู ุจุงุณุชุฎุฏุงู:
  ```javascript
  console.log('SUCCESS_URL:', process.env.MYFATOORAH_SUCCESS_URL);
  console.log('ERROR_URL:', process.env.MYFATOORAH_ERROR_URL);
  ```

## ๐ฑ ูุชุทูุจุงุช Flutter

ุชุฃูุฏ ูู ุชูููู Deep Links ูู ุงูุชุทุจูู:

### Android (`AndroidManifest.xml`):
```xml
<intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE" />
    <data android:scheme="3roudapp" />
</intent-filter>
```

### iOS (`Info.plist`):
```xml
<key>CFBundleURLTypes</key>
<array>
    <dict>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>3roudapp</string>
        </array>
    </dict>
</array>
```

## ๐จ ุชุฎุตูุต ุงูุตูุญุงุช

ููููู ุชุนุฏูู ุงูุตูุญุงุช HTML ูุชุชูุงุณุจ ูุน ุนูุงูุชู ุงูุชุฌุงุฑูุฉ:
- ุชุบููุฑ ุงูุฃููุงู ูู CSS
- ุชุนุฏูู ุงููุตูุต
- ุฅุถุงูุฉ ุดุนุงุฑ ุงูุดุฑูุฉ
- ุชุบููุฑ ูุฏุฉ ุงูุชูุฌูู ุงูุชููุงุฆู (ุญุงููุงู 500ms)

## โจ ุงููููุฒุงุช

- โ ุชุตููู ุฌููู ููุชุฌุงูุจ
- โ ุฏุนู ุงููุบุฉ ุงูุนุฑุจูุฉ (RTL)
- โ ุชูุฌูู ุชููุงุฆู ุจุนุฏ 500ms
- โ ุฒุฑ ุงุญุชูุงุทู ูุธูุฑ ุจุนุฏ ุซุงููุชูู
- โ ุฑุณุงุฆู ูุงุถุญุฉ ูููุณุชุฎุฏู
- โ ุฃููููุดู ุณูุณ
- โ ุฏุนู ุฌููุน ุงูุจุงุฑุงูุชุฑุงุช

## ๐ ุงูุฃูุงู

- ุงูุตูุญุงุช HTML ูุง ุชุญุชูู ุนูู ูุนูููุงุช ุญุณุงุณุฉ
- ุฌููุน ุงูุจูุงูุงุช ุชูุฑ ุนุจุฑ URL parameters
- ุงูุชุญูู ูู ุงูุฏูุน ูุชู ูู ุงูู Backend
- Webhook ูุคูุฏ ุงูุฏูุน ุจุดูู ุขูู

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู logs ุงูู Backend
2. ุชุญูู ูู Developer Console ูู ุงููุชุตูุญ
3. ุชุญูู ูู logs ุงูุชุทุจูู ูู Flutter
4. ุชุฃูุฏ ูู ุชูููู MyFatoorah ุจุดูู ุตุญูุญ
